"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t,e=require("react"),a=(t=e)&&"object"==typeof t&&"default"in t?t.default:t;function i(){return(i=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(t[i]=a[i])}return t}).apply(this,arguments)}function r(t,e){if(null==t)return{};var a,i,r={},n=Object.keys(t);for(i=0;i<n.length;i++)e.indexOf(a=n[i])>=0||(r[a]=t[a]);return r}var n="clip_level_meter",l={canvasWidth:100,canvasHeight:52,aspectRatio:.52,padding:0,value:50,chargingStartValue:1,maxValue:100,clipPathHash:"",orientation:"horizontal",animated:!1,charging:!1,customization:{batteryBody:{strokeWidth:4,cornerRadius:6,fill:"none",strokeColor:"#111"},batteryCap:{fill:"none",strokeWidth:4,strokeColor:"#111",cornerRadius:2,capToBodyRatio:.4},batteryMeter:{fill:"green",lowBatteryValue:15,lowBatteryFill:"red",outerGap:1,noOfCells:1,interCellsGap:1},readingText:{lightContrastColor:"#111",darkContrastColor:"#fff",lowBatteryColor:"red",fontFamily:"Helvetica",fontSize:14,showPercentage:!0},chargingFlash:{scale:void 0,fill:"orange",animated:!0,animationDuration:1e3}}},o=e.createContext(l);function c(){return e.useContext(o)}var u=function(t){var e=c(),a=e.canvasHeight,i=e.padding,r=(a-2*i)*t,n=r/2;return{bodyWidth:e.canvasWidth-n-2*i,bodyHeight:a-2*i,capWidth:n,capHeight:r}},d=function(){var t=c(),e=t.canvasWidth,i=t.canvasHeight,r=t.padding,n=t.customization,l=t.clipPathHash,o=n.batteryBody,d=o.strokeColor,s=o.strokeWidth,h=o.fill,m=o.cornerRadius,g=n.batteryCap,f=g.strokeColor,v=g.strokeWidth,y=g.fill,p=g.cornerRadius,b=u(g.capToBodyRatio),x=b.bodyWidth,w=b.bodyHeight,C=b.capWidth,E=b.capHeight;return a.createElement("g",null,a.createElement("defs",null,a.createElement("clipPath",{id:"battery_cap_clip"+l},a.createElement("rect",{x:e-r-C,y:(i-E-v)/2,width:C,height:E+v,strokeWidth:v}))),a.createElement("rect",{className:"batteryBody",x:r,y:r,rx:m,ry:m,width:x,height:w,strokeWidth:s,fill:h,stroke:d}),a.createElement("rect",{clipPath:"url(#battery_cap_clip"+l+")",className:"batteryCap",x:e-r-C-p,y:(i-E)/2,rx:p,ry:p,width:C,height:E,strokeWidth:v,fill:y,stroke:f}))},s=function(t){return a.createElement(o.Provider,{value:t.value},t.children)},h=["children","canvasWidth","canvasHeight","padding","value","chargingStartValue","maxValue","orientation","customization","clipPathHash"],m=function(t){var e=t.children,i=t.canvasWidth,n=t.canvasHeight,l=t.padding,o=t.value,c=t.chargingStartValue,u=t.maxValue,d=t.orientation,m=t.customization,g=t.clipPathHash,f=r(t,h);return a.createElement(s,{value:{canvasWidth:i,canvasHeight:n,padding:l,value:o,chargingStartValue:c,maxValue:u,orientation:d,customization:m,clipPathHash:g}},a.createElement("svg",Object.assign({viewBox:"0 0 "+i+" "+n},f),e))},g=function(){var t=c(),a=t.padding,i=t.customization,r=i.batteryBody.strokeWidth,n=i.batteryMeter.outerGap,l=u(i.batteryCap.capToBodyRatio),o=l.bodyWidth,d=l.bodyHeight;return e.useMemo((function(){return{x:a+r/2+n,y:a+r/2+n,width:o-r-2*n,height:d-r-2*n}}),[o,d,n,a,r])};function f(t,e){return t<e}function v(t,e,a){return Math.floor(Math.abs(t/e)*a)}var y=function(){var t=c(),i=t.value,r=t.maxValue,l=t.customization,o=t.clipPathHash,u=g(),d=u.x,s=u.y,h=u.width,m=u.height,y=l.batteryMeter,p=y.fill,b=y.lowBatteryFill,x=y.gradFill,w=y.lowBatteryValue,C=y.outerGap,E=y.noOfCells,V=y.interCellsGap,z=l.batteryBody,M=z.strokeWidth,P=z.cornerRadius,B=e.useMemo((function(){var t=v(i,r,E);return 0===t&&i>0?["cell"]:new Array(t).fill("cell")}),[i,r,E]);return a.createElement("g",null,a.createElement("defs",null,a.createElement("clipPath",{id:n+o},a.createElement("rect",{x:d,y:s,rx:P-M/2-C,ry:P-M/2-C,width:h,height:m})),E<2&&x&&a.createElement("linearGradient",{id:"levelGradient"+o},x.map((function(t){return a.createElement("stop",{key:t.color,offset:t.offset+"%",stopColor:t.color})})))),1===E&&a.createElement("g",null,a.createElement("rect",x?{className:"batteryMeter",clipPath:"url(#clip_level_meter_filled"+o+")",x:d,y:s,width:h,height:m,fill:"url(#levelGradient"+o+")"}:{className:"batteryMeter",clipPath:"url(#"+(n+o)+")",x:d,y:s,width:h*i/r,height:m,fill:f(i,w)?b:p})),a.createElement("g",null,E>1&&B.map((function(t,e){return a.createElement("rect",{key:e,className:"batteryMeter",clipPath:"url(#"+(n+o)+")",x:d+(h+V)/E*e,y:s,width:h/E-V,height:m,fill:f(i,w)?b:p})}))))},p=["fontFamily","darkContrastColor","lightContrastColor","lowBatteryColor","showPercentage","fontSize"],b=function(t){var e=t.formatValue,i=c(),l=i.value,o=i.maxValue,u=i.orientation,d=i.customization,s=i.clipPathHash,h=g(),m=h.x,y=h.y,b=h.width,x=h.height,w=d.readingText,C=w.fontFamily,E=w.darkContrastColor,V=w.lightContrastColor,z=w.lowBatteryColor,M=w.showPercentage,P=w.fontSize,B=r(w,p),W=d.batteryMeter,k=W.lowBatteryValue,_=W.noOfCells,H=W.interCellsGap,F=M?"%":"",O=l/o,S=_>1,R=v(l,o,_),j=_-R,G=b/_,T=function(t,e){return Math.round(t/e*100)}(l,o),A=function(t,i){return a.createElement("text",Object.assign({className:"readingText",x:m+b/2,y:y+x/2,dominantBaseline:"middle",textAnchor:"middle",clipPath:"url(#"+i+")",fill:f(l,k)?z:t,fontFamily:C,fontWeight:"bold",fontSize:P,writingMode:"vertical"===u?"tb":"lr"},B),e(T)+F)},N=Math.max(S?G*R-H/2:b*O,0);return a.createElement("g",null,a.createElement("defs",null,a.createElement("clipPath",{id:"clip_level_meter_filled"+s},a.createElement("rect",{x:m,y:y,width:N,height:x,clipPath:"url(#"+(n+s)+")"})),a.createElement("clipPath",{id:"clip_level_meter_empty"+s},a.createElement("rect",{x:m+N,y:y,width:S?G*j:b*(1-O),height:x,clipPath:"url(#"+(n+s)+")"}))),A(E,"clip_level_meter_filled"+s),A(V,"clip_level_meter_empty"+s))},x=function(t){var a=t.value,i=t.duration,r=void 0===i?1e3:i,n=t.startValue,l=t.enabled,o=void 0!==l&&l,c=t.direction,u=void 0===c?"forward":c,d=t.iterationCount,s=void 0===d?1:d,h=e.useState(void 0===n?0:n),m=h[0],g=h[1],f=e.useRef(0),v=e.useCallback((function(){return f.current+=1,new Promise((function(t){var e=0,i=function i(n){e||(e=n);var l,o=function(t,e){return t}(Math.min((n-e)/r,"both"===u?2:1)),c="reverse"===(l=u)?(1-o)*(a-m)+m:o>1&&"both"===l?(2-o)*(a-m)+m:o*(a-m)+m;g(Math.floor(c)),o<1||"both"===u&&o<2?window.requestAnimationFrame(i):(window.cancelAnimationFrame(window.requestAnimationFrame(i)),t(!0))};f.current>1?setTimeout((function(){window.requestAnimationFrame(i)}),r/5):window.requestAnimationFrame(i)}))}),[a]);return e.useEffect((function(){if(o){var t=v();!function e(){t.then((function(){return"infinite"===s||f.current<s?(t=v(),void e()):void 0}))}()}}),[o,s,a]),o?m:a};function w(t){var e=c(),i=e.canvasWidth,r=e.canvasHeight,n=e.orientation,l=e.customization,o=l.batteryBody.strokeWidth,u=l.chargingFlash,d=u.fill,s=u.scale,h=x({value:100,enabled:u.animated,direction:"both",iterationCount:"infinite",duration:u.animationDuration,startValue:20}),m=g(),f=s?"scale("+s+")":"";return a.createElement("g",{transform:"vertical"===n?"rotate(-90)"+f:f,style:{transformOrigin:i/2-o+"px "+(r/2-o/2)+"px"},opacity:h/100},a.createElement("path",Object.assign({d:"M"+(m.width/2+8.4)+","+(r/2-14.35)+"l-13,16.8l7.4,0l-1.8,11.9l11.2,-16.8l-7.4,0l3.6,-11.9z",fill:d},t)))}var C=["size","aspectRatio","children","padding","value","chargingStartValue","maxValue","customization","orientation","animated","charging","formatValue"],E=function(t){var n,o,c,u,s,h=t.size,g=void 0===h?300:h,f=t.aspectRatio,v=void 0===f?l.aspectRatio:f,p=t.children,E=t.padding,V=void 0===E?l.padding:E,z=t.value,M=void 0===z?l.value:z,P=t.chargingStartValue,B=void 0===P?l.chargingStartValue:P,W=t.maxValue,k=void 0===W?l.maxValue:W,_=t.customization,H=void 0===_?l.customization:_,F=t.orientation,O=void 0===F?l.orientation:F,S=t.animated,R=void 0===S?l.animated:S,j=t.charging,G=void 0===j?l.charging:j,T=t.formatValue,A=void 0===T?function(t){return t}:T,N=r(t,C),q=Math.round(100*v),D=Math.round(g*v),I=(u=(c=e.useState(""))[0],s=c[1],e.useEffect((function(){s((Math.random()+1).toString(36).substring(7))}),[]),u),J=G?{lowBatteryFill:(null==(n=H.batteryMeter)?void 0:n.fill)||l.customization.batteryMeter.fill}:{},K=((o={}).batteryBody=i({},l.customization.batteryBody,H.batteryBody),o.batteryCap=i({},l.customization.batteryCap,H.batteryCap),o.batteryMeter=i({},l.customization.batteryMeter,H.batteryMeter,J),o.readingText=i({},l.customization.readingText,H.readingText),o.chargingFlash=i({},l.customization.chargingFlash,H.chargingFlash),o),L=K.batteryBody.strokeWidth/2+V,Q=x({value:M,enabled:R}),U=x({startValue:B,value:k,enabled:G,iterationCount:"infinite",duration:2e3});return a.createElement(m,Object.assign({width:g,height:"vertical"===O?g:D,canvasWidth:100,canvasHeight:q,padding:L,value:G?U:Q,chargingStartValue:B,maxValue:k||1,orientation:O,customization:K,clipPathHash:I},N),a.createElement("g",{transform:"vertical"===O?"rotate(-90,50,"+q/2+")":""},a.createElement(d,null),a.createElement(y,null),G?a.createElement(w,null):a.createElement(b,{formatValue:A}),p))};exports.BatteryGauge=E,exports.default=E;
//# sourceMappingURL=react-battery-gauge.cjs.production.min.js.map
